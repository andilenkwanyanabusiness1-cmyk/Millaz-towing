<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Millaz Towing | KZN's Premier Recovery & Authority Hub</title>
    <meta name="description"
        content="Millaz Towing is KZN's most trusted recovery service. Offering 24/7 towing, expert safety tips, and a community-driven authority hub.">
    <link rel="stylesheet" href="style.css?v=visual_upgrade_v1">
    <link rel="stylesheet" href="authority-hub/hub.css?v=2">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- GSAP for advanced animations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollToPlugin.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/Draggable.min.js"></script>
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
</head>

<body>
    <!-- Scroll Progress Indicator -->
    <div id="scroll-progress-container">
        <div id="scroll-progress-bar"></div>
    </div>
    <nav class="glass-panel">
        <div class="nav-container">
            <div class="logo">
                <img src="assets/millaz_logo_final.png" alt="Millaz Towing Logo">
            </div>
            <ul class="nav-links">
                <li><a href="#services">Services</a></li>
                <li><a href="authority-hub/index.html">Authority Hub</a></li>
                <li><a href="#community">Community</a></li>
            </ul>
            <a href="tel:0737453329" class="btn-primary"><i class="fas fa-phone"></i> Emergency Call</a>
        </div>
    </nav>

    <!-- WhatsApp Chat Button -->
    <a href="https://wa.me/27737453329" class="whatsapp-btn" target="_blank" rel="noopener noreferrer">
        <i class="fab fa-whatsapp"></i>
    </a>

    <main>
        <!-- Hero Section -->
        <section class="hero" id="hero">
            <div class="hero-bg">
                <img src="assets/hero-final-4.jpg" alt="Millaz Towing Team Fleet">
            </div>
            <div class="hero-content">
                <div class="hero-text animate-in">
                    <h1><span class="brand-script">Millaz Towing</span> <span class="hero-subtitle">RECOVERY
                            REDEFINED.</span></h1>
                    <p>More than just a tow. We're KZN's authority in road safety, recovery, and community support.</p>
                </div>

                <div class="glass-panel lead-card animate-in">
                    <h3>Request Immediate Tow</h3>
                    <p>Enter your details and our team will be dispatched instantly.</p>
                    <form id="emergency-form">
                        <div class="form-group">
                            <input type="text" name="first_name" placeholder="First Name" required>
                        </div>
                        <div class="form-group">
                            <input type="text" name="last_name" placeholder="Last Name" required>
                        </div>
                        <div class="form-group">
                            <input type="tel" name="contact_number" placeholder="073 745 3329" required>
                        </div>
                        <div class="form-group">
                            <input type="email" name="email" placeholder="Email (optional)">
                        </div>
                        <div class="form-group">
                            <select name="service_type" required>
                                <option value="" disabled selected>Select Service</option>
                                <option value="immediate_tow">Immediate Tow</option>
                                <option value="roadside_assistance">Roadside Assistance</option>
                                <option value="accident_recovery">Accident Recovery</option>
                                <option value="vehicle_transport">Vehicle Transport</option>
                            </select>
                        </div>
                        <button type="submit" id="dispatch-btn" class="btn-primary w-full">Dispatch Now</button>
                        <div id="dispatch-message"></div>
                    </form>
                </div>
            </div>
        </section>

        <!-- Trusted Providers Section -->
        <section class="trusted-providers-section animate-in">
            <div class="container">
                <h2 class="section-heading">Trusted Service Provider For</h2>

                <div class="logos-grid">
                    <!-- Row 1: 9 logos -->
                    <div class="logos-row row-9">
                        <div class="logo-item"><img src="assets/insurance-logos/old mutual.png" alt="Old Mutual"></div>
                        <div class="logo-item"><img src="assets/insurance-logos/king price.png" alt="King Price"></div>
                        <div class="logo-item"><img src="assets/insurance-logos/hollard.png" alt="Hollard"></div>
                        <div class="logo-item"><img src="assets/insurance-logos/santam.png" alt="Santam"></div>
                        <div class="logo-item"><img src="assets/insurance-logos/momentum.png" alt="Momentum"></div>
                        <div class="logo-item"><img src="assets/insurance-logos/miway.png" alt="MiWay"></div>
                        <div class="logo-item"><img src="assets/insurance-logos/iwyze.png" alt="iWyze"></div>
                        <div class="logo-item"><img src="assets/insurance-logos/dialdirect.png" alt="Dialdirect"></div>
                        <div class="logo-item"><img src="assets/insurance-logos/discovery.png" alt="Discovery"></div>
                    </div>

                    <!-- Row 2: 7 logos (centered) -->
                    <div class="logos-row row-7">
                        <div class="logo-item"><img src="assets/insurance-logos/outsurance.png" alt="OUTsurance"></div>
                        <div class="logo-item"><img src="assets/insurance-logos/AA.png" alt="AA"></div>
                        <div class="logo-item"><img src="assets/insurance-logos/budget insurance.png" alt="Budget">
                        </div>
                        <div class="logo-item"><img src="assets/insurance-logos/pmd.png" alt="PMD"></div>
                        <div class="logo-item"><img src="assets/insurance-logos/1st for women.png" alt="1st for Women">
                        </div>
                        <div class="logo-item"><img src="assets/insurance-logos/absa.png" alt="ABSA"></div>
                        <div class="logo-item"><img src="assets/insurance-logos/fnb.png" alt="FNB"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Statistics Section -->
        <section class="stats-section">
            <div class="stats-container">
                <div class="stat-card glass-panel animate-in">
                    <div class="stat-number" data-target="950">0</div>
                    <div class="stat-label">Satisfied Clients</div>
                </div>
                <div class="stat-card glass-panel animate-in" style="transition-delay: 0.1s;">
                    <div class="stat-number" data-target="1304">0</div>
                    <div class="stat-label">Accident Scenes Cleared</div>
                </div>
                <div class="stat-card glass-panel animate-in" style="transition-delay: 0.2s;">
                    <div class="stat-number" data-target="50">0</div>
                    <div class="stat-label">Jumpstarts This Year</div>
                </div>
                <div class="stat-card glass-panel animate-in" style="transition-delay: 0.3s;">
                    <div class="stat-number" data-target="15">0</div>
                    <div class="stat-label">Avg. Response (Mins)</div>
                </div>
            </div>
        </section>

        <!-- Service Hub -->
        <section id="services" class="services">
            <div class="section-header center">
                <h2>Pro-Service Hub</h2>
                <div class="teal-line"></div>
                <p>Industry-leading recovery solutions for individuals and enterprises across KZN.</p>
            </div>
            <div class="services-grid">
                <!-- 1. Emergency Towing -->
                <div class="glass-panel service-card animate-in">
                    <div class="card-icon"><i class="fas fa-truck-fast"></i></div>
                    <h3>Emergency Towing</h3>
                    <p>Rapid response for urgent vehicle issues. We get you off the road safely.</p>
                </div>

                <!-- 2. Vehicle Recovery -->
                <div class="glass-panel service-card animate-in" style="animation-delay: 0.1s;">
                    <div class="card-icon"><i class="fas fa-truck-pickup"></i></div>
                    <h3>Vehicle Recovery</h3>
                    <p>Safe and swift retrieval after collisions or off-road incidents.</p>
                </div>

                <!-- 3. Roadside Assistance -->
                <div class="glass-panel service-card animate-in" style="animation-delay: 0.2s;">
                    <div class="card-icon"><i class="fas fa-screwdriver-wrench"></i></div>
                    <h3>Roadside Assistance</h3>
                    <p>On-the-spot help for minor breakdowns to get you moving again.</p>
                </div>

                <!-- 4. Fuel Assist -->
                <div class="glass-panel service-card animate-in" style="animation-delay: 0.3s;">
                    <div class="card-icon"><i class="fas fa-gas-pump"></i></div>
                    <h3>Fuel Assist</h3>
                    <p>Run out of fuel? We'll deliver what you need to reach the next station.</p>
                </div>

                <!-- 5. Flat Battery Assist -->
                <div class="glass-panel service-card animate-in" style="animation-delay: 0.4s;">
                    <div class="card-icon"><i class="fas fa-car-battery"></i></div>
                    <h3>Flat Battery Assist</h3>
                    <p>Jump-start services to revive your dead battery quickly.</p>
                </div>

                <!-- 6. Tyre Change -->
                <div class="glass-panel service-card animate-in" style="animation-delay: 0.5s;">
                    <div class="card-icon"><i class="fas fa-compact-disc"></i></div>
                    <h3>Tyre Change</h3>
                    <p>Professional tire replacement or spare fitting for flat tires.</p>
                </div>
            </div>
        </section>
        <!-- Authority Hub -->
        <section id="hub" class="hub">
            <div class="hub-container">
                <div class="section-header">
                    <h2>Authority Hub</h2>
                    <p>Expert insights and safety resources for the KZN community.</p>
                </div>

                <div class="hub-grid">
                    <div class="featured-article glass-panel animate-in">
                        <img src="assets/hub-safety.jpg?v=2" alt="Post-Accident Management">
                        <div class="article-overlay">
                            <span class="tag">Strategic Safety</span>
                            <h3>Critical Protocols: Post-Accident Management</h3>
                            <p>Mastering the first 15 minutes of an accident scene to ensure driver safety and vehicle
                                security.</p>
                            <a href="authority-hub/post-accident-management.html" class="btn-primary"
                                style="margin-top: 1rem;">Full Protocol</a>
                        </div>
                    </div>

                    <div class="sidebar-articles animate-in" style="animation-delay: 0.2s;">
                        <div class="mini-article">
                            <div class="mini-img">
                                <img src="/assets/top-5-breakdowns-n3.jpeg" alt="N3 Breakdown Causes">
                            </div>
                            <div class="mini-info">
                                <span class="tag" style="font-size: 0.6rem;">Road Safety</span>
                                <h4>Top 5 Causes of Vehicle Breakdowns on the N3</h4>
                                <a href="authority-hub/vehicle-breakdowns-n3.html" class="learn-more">Read Insight</a>
                            </div>
                        </div>

                        <div class="mini-article">
                            <div class="mini-img">
                                <img src="assets/hub-app.jpg?v=2" alt="Community">
                            </div>
                            <div class="mini-info">
                                <span class="tag" style="font-size: 0.6rem;">Community</span>
                                <h4>How the Spotter App is Securing KZN Roads</h4>
                                <a href="authority-hub/spotter-app-kzn-roads.html" class="learn-more">Read Impact</a>
                            </div>
                        </div>

                        <div class="mini-article">
                            <div class="mini-img">
                                <img src="assets/hub-recovery.jpg?v=2" alt="Towing Regulations">
                            </div>
                            <div class="mini-info">
                                <span class="tag" style="font-size: 0.6rem;">Regulations</span>
                                <h4>Understanding Towing Regulations in KZN</h4>
                                <a href="authority-hub/towing-regulations-kzn.html" class="learn-more">Read Report</a>
                            </div>
                        </div>

                        <div class="glass-panel newsletter-card" style="padding: 1.5rem; margin-top: 1rem;">
                            <h4>Join the Community</h4>
                            <p style="font-size: 0.9rem; color: var(--text-muted); margin: 0.5rem 0 1rem;">Get road
                                safety alerts & special offers.</p>
                            <form id="index-newsletter-form" class="mini-form">
                                <div class="form-group" style="margin-bottom: 0.5rem;">
                                    <input type="text" name="first_name" placeholder="First Name" required
                                        style="width: 100%; padding: 0.8rem; border-radius: 8px; background: rgba(255,255,255,0.05); border: 1px solid var(--glass-border); color: #fff;">
                                </div>
                                <div class="form-group" style="margin-bottom: 0.5rem;">
                                    <input type="text" name="last_name" placeholder="Last Name" required
                                        style="width: 100%; padding: 0.8rem; border-radius: 8px; background: rgba(255,255,255,0.05); border: 1px solid var(--glass-border); color: #fff;">
                                </div>
                                <div class="form-group" style="margin-bottom: 0.5rem;">
                                    <input type="email" name="email" placeholder="Email Address" required
                                        style="width: 100%; padding: 0.8rem; border-radius: 8px; background: rgba(255,255,255,0.05); border: 1px solid var(--glass-border); color: #fff;">
                                </div>
                                <button type="submit" id="index-subscribe-btn" class="btn-primary w-full"
                                    style="padding: 0.8rem;">Subscribe</button>
                                <div id="index-newsletter-message" style="margin-top: 0.5rem; font-size: 0.8rem;"></div>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="hub-footer-cta center animate-in" style="margin-top: 2rem; text-align: center;">
                    <a href="authority-hub/index.html" class="btn-primary">View All Articles <i
                            class="fas fa-arrow-right"></i></a>
                </div>
            </div>
        </section>
        <!-- Community Corner -->
        <section id="community" class="community">
            <div class="section-header center">
                <h2>Meet Our Fleet and Team</h2>
                <div class="teal-line"></div>
                <p>Real recoveries, real people. Join the Millaz community in KZN.</p>
            </div>

            <div class="gallery-preview animate-in">
                <div class="gallery-wrapper">
                    <div class="gallery-track">
                        <img src="assets/gallery/WhatsApp Image 2025-11-05 at 2.07.29 PM.jpeg?v=2"
                            alt="Millaz Recovery 1">
                        <img src="assets/gallery/WhatsApp Image 2025-11-05 at 2.07.30 PM.jpeg?v=2"
                            alt="Millaz Recovery 2">
                        <img src="assets/gallery/WhatsApp Image 2025-11-05 at 2.07.31 PM (1).jpeg?v=2"
                            alt="Millaz Recovery 3">
                        <img src="assets/gallery/WhatsApp Image 2025-11-05 at 2.07.31 PM (2).jpeg?v=2"
                            alt="Millaz Recovery 4">
                        <img src="assets/gallery/WhatsApp Image 2025-11-05 at 2.07.31 PM.jpeg?v=2"
                            alt="Millaz Recovery 5">
                        <img src="assets/gallery/WhatsApp Image 2025-11-05 at 2.07.34 PM.jpeg?v=2"
                            alt="Millaz Recovery 6">
                        <img src="assets/gallery/WhatsApp Image 2025-11-05 at 2.07.35 PM (1).jpeg?v=2"
                            alt="Millaz Recovery 7">
                        <img src="assets/gallery/WhatsApp Image 2025-11-05 at 2.07.35 PM (2).jpeg?v=2"
                            alt="Millaz Recovery 8">
                        <img src="assets/gallery/WhatsApp Image 2025-11-05 at 2.07.35 PM.jpeg?v=2"
                            alt="Millaz Recovery 9">
                        <img src="assets/gallery/WhatsApp Image 2025-11-05 at 2.07.36 PM (1).jpeg?v=2"
                            alt="Millaz Recovery 10">
                        <img src="assets/gallery/WhatsApp Image 2025-11-05 at 2.07.36 PM (2).jpeg?v=2"
                            alt="Millaz Recovery 11">
                        <img src="assets/gallery/WhatsApp Image 2025-11-05 at 2.07.36 PM.jpeg?v=2"
                            alt="Millaz Recovery 12">
                        <img src="assets/gallery/WhatsApp Image 2025-11-05 at 2.07.37 PM (1).jpeg?v=2"
                            alt="Millaz Recovery 13">
                        <img src="assets/gallery/WhatsApp Image 2025-11-05 at 2.07.37 PM.jpeg?v=2"
                            alt="Millaz Recovery 14">
                        <img src="assets/gallery/WhatsApp Image 2025-11-05 at 2.07.38 PM (1).jpeg?v=2"
                            alt="Millaz Recovery 15">
                        <img src="assets/gallery/WhatsApp Image 2025-11-05 at 2.07.38 PM.jpeg?v=2"
                            alt="Millaz Recovery 16">
                        <img src="assets/gallery/WhatsApp Image 2025-11-05 at 2.07.39 PM (1).jpeg?v=2"
                            alt="Millaz Recovery 17">
                        <img src="assets/gallery/WhatsApp Image 2025-11-05 at 2.08.22 PM.jpeg?v=2"
                            alt="Millaz Recovery 18">
                        <img src="assets/gallery/WhatsApp Image 2025-11-05 at 2.08.23 PM (1).jpeg?v=2"
                            alt="Millaz Recovery 19">
                        <img src="assets/gallery/WhatsApp Image 2025-11-05 at 2.08.23 PM.jpeg?v=2"
                            alt="Millaz Recovery 20">
                        <img src="assets/gallery/WhatsApp Image 2025-12-19 at 12.57.01 PM (1).jpeg?v=2"
                            alt="Millaz Recovery 21">
                        <img src="assets/gallery/WhatsApp Image 2025-12-19 at 12.57.01 PM (2).jpeg?v=2"
                            alt="Millaz Recovery 22">
                        <img src="assets/gallery/WhatsApp Image 2025-12-19 at 12.57.00 PM (1).jpeg?v=2"
                            alt="Millaz Recovery 23">
                        <img src="assets/gallery/WhatsApp Image 2025-12-19 at 12.57.00 PM.jpeg?v=2"
                            alt="Millaz Recovery 24">
                        <img src="assets/gallery/WhatsApp Image 2025-12-19 at 12.56.59 PM (1).jpeg?v=2"
                            alt="Millaz Recovery 25">
                        <img src="assets/gallery/WhatsApp Image 2025-12-19 at 12.56.59 PM (2).jpeg?v=2"
                            alt="Millaz Recovery 26">
                        <img src="assets/gallery/WhatsApp Image 2025-12-19 at 12.56.59 PM.jpeg?v=2"
                            alt="Millaz Recovery 27">
                        <img src="assets/gallery/WhatsApp Image 2025-12-19 at 12.56.58 PM (1).jpeg?v=2"
                            alt="Millaz Recovery 28">
                        <img src="assets/gallery/WhatsApp Image 2025-12-19 at 12.56.58 PM.jpeg?v=2"
                            alt="Millaz Recovery 29">
                        <img src="assets/gallery/WhatsApp Image 2025-12-19 at 12.56.57 PM (1).jpeg?v=2"
                            alt="Millaz Recovery 30">
                        <img src="assets/gallery/WhatsApp Image 2025-12-19 at 12.56.57 PM.jpeg?v=2"
                            alt="Millaz Recovery 31">
                    </div>
                </div>
                <div class="gallery-controls">
                    <button id="prev-btn" class="btn-glass"><i class="fas fa-chevron-left"></i></button>
                    <button id="next-btn" class="btn-glass"><i class="fas fa-chevron-right"></i></button>
                </div>
            </div>
        </section>

        <!-- Testimonials Section -->
        <section class="testimonials" id="reviews">
            <div class="section-header center">
                <h2>Client Reviews</h2>
                <div class="teal-line"></div>
                <p>Don't just take our word for it. Here's what KZN has to say.</p>
            </div>

            <div class="hub-container">
                <div class="testimonial-grid">
                    <!-- Review 1 -->
                    <div class="testimonial-card animate-in">
                        <div class="stars">
                            <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i
                                class="fas fa-star"></i><i class="fas fa-star"></i>
                        </div>
                        <p class="review-text">"Fastest service in Durban! Had a flat tyre at 2am and Millaz was there
                            in 20 minutes. Professional and kind."</p>
                        <div class="client-info">
                            <div class="client-avatar">JP</div>
                            <div class="client-details">
                                <h4>Jason P.</h4>
                                <span>Umhlanga</span>
                            </div>
                        </div>
                    </div>

                    <!-- Review 2 -->
                    <div class="testimonial-card animate-in" style="animation-delay: 0.1s;">
                        <div class="stars">
                            <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i
                                class="fas fa-star"></i><i class="fas fa-star"></i>
                        </div>
                        <p class="review-text">"The only towing service I trust with my luxury vehicle. Handled my BMW
                            with absolute care. Highly recommended!"</p>
                        <div class="client-info">
                            <div class="client-avatar">SM</div>
                            <div class="client-details">
                                <h4>Sarah M.</h4>
                                <span>Ballito</span>
                            </div>
                        </div>
                    </div>

                    <!-- Review 3 -->
                    <div class="testimonial-card animate-in" style="animation-delay: 0.2s;">
                        <div class="stars">
                            <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i
                                class="fas fa-star"></i><i class="fas fa-star"></i>
                        </div>
                        <p class="review-text">"Incredible team. They managed a complex accident recovery for our fleet
                            efficiently and safely. A true partner."</p>
                        <div class="client-info">
                            <div class="client-avatar">TK</div>
                            <div class="client-details">
                                <h4>Thabo K.</h4>
                                <span>Logistics Manager</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <footer>
        <div class="footer-content">
            <div class="footer-brand">
                <img src="assets/millaz_logo_final.png" alt="Millaz Footer Logo">
                <p>Setting the standard for professional recovery in KZN.</p>
            </div>
            <div class="footer-links">
                <h4>Quick Links</h4>
                <ul>
                    <li><a href="#services">Services</a></li>
                    <li><a href="authority-hub/index.html">Authority Hub</a></li>
                    <li><a href="#community">Community</a></li>
                    <li><a href="#">Privacy Policy</a></li>
                </ul>
            </div>
            <div class="footer-contact">
                <h4>Contact Us</h4>
                <div class="contact-info">
                    <p><strong>Call Us 24/7</strong></p>
                    <p>📱 Cell: <a href="tel:0737453329">073 745 3329</a></p>
                    <p>☎️ Tel: <a href="tel:0312735137">031 273 5137</a></p>
                </div>
                <p><i class="fas fa-envelope"></i> help@millaztowing.co.za</p>
                <div class="social-icons">
                    <a href="#"><i class="fab fa-facebook"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                    <a href="https://wa.me/27737453329"><i class="fab fa-whatsapp"></i></a>
                </div>
            </div>
            <div class="footer-map">
                <h4>Find Us</h4>
                <p>22, 24 Gillitts Road<br>West Mead, Durban, 4091</p>
                <div class="map-frame">
                    <iframe
                        src="https://maps.google.com/maps?q=22+24+Gillitts+Road+West+Mead+Durban+4091&t=&z=13&ie=UTF8&iwloc=&output=embed"
                        width="100%" height="150" style="border:0; border-radius: 8px;" allowfullscreen=""
                        loading="lazy"></iframe>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2026 Millaz Towing. All Rights Reserved.</p>
        </div>
    </footer>

    <script src="main.js"></script>
    <script>
        const SUPABASE_URL = 'https://ygrsuwvumbdbacbpagfb.supabase.co';
        const SUPABASE_ANON_KEY = 'sb_publishable_AllqobGS8ujKcLJMw1iecw_nAwkEifW';

        // Emergency Service Request Form
        const emergencyForm = document.getElementById('emergency-form');
        if (emergencyForm) {
            emergencyForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const dispatchBtn = document.getElementById('dispatch-btn');
                const messageDiv = document.getElementById('dispatch-message');
                const formData = new FormData(emergencyForm);

                dispatchBtn.textContent = 'Dispatching...';
                dispatchBtn.disabled = true;

                const requestData = {
                    first_name: formData.get('first_name'),
                    last_name: formData.get('last_name'),
                    contact_number: formData.get('contact_number'),
                    email: formData.get('email') || null,
                    service_type: formData.get('service_type')
                };

                try {
                    const response = await fetch(`${SUPABASE_URL}/rest/v1/service_requests`, {
                        method: 'POST',
                        headers: {
                            'apikey': SUPABASE_ANON_KEY,
                            'Content-Type': 'application/json',
                            'Prefer': 'return=minimal'
                        },
                        body: JSON.stringify(requestData)
                    });

                    if (response.ok) {
                        messageDiv.innerHTML = `<p style="color: #4CAF50; margin-top: 1rem;">✓ Team dispatched! We'll contact you at ${requestData.contact_number} within 5 minutes.</p>`;
                        emergencyForm.reset();
                    } else {
                        throw new Error('Dispatch failed');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    messageDiv.innerHTML = '<p style="color: #ff4d4d; margin-top: 1rem;">Unable to dispatch. Please call us: <a href="tel:0737453329" style="color: #fff; text-decoration: underline;">073 745 3329</a></p>';
                } finally {
                    dispatchBtn.textContent = 'Dispatch Now';
                    dispatchBtn.disabled = false;
                }
            });
        }

        // Sidebar Newsletter Form
        const newsletterForm = document.getElementById('index-newsletter-form');
        if (newsletterForm) {
            newsletterForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const subscribeBtn = document.getElementById('index-subscribe-btn');
                const messageDiv = document.getElementById('index-newsletter-message');
                const formData = new FormData(newsletterForm);

                subscribeBtn.textContent = 'Subscribing...';
                subscribeBtn.disabled = true;

                try {
                    const response = await fetch(`${SUPABASE_URL}/rest/v1/newsletter_subscribers`, {
                        method: 'POST',
                        headers: {
                            'apikey': SUPABASE_ANON_KEY,
                            'Content-Type': 'application/json',
                            'Prefer': 'return=minimal'
                        },
                        body: JSON.stringify({
                            first_name: formData.get('first_name'),
                            last_name: formData.get('last_name'),
                            email: formData.get('email'),
                            source_page: window.location.pathname
                        })
                    });

                    if (response.ok) {
                        messageDiv.innerHTML = '<p style="color: #4CAF50;">✓ Subscribed! Check your email.</p>';
                        newsletterForm.reset();
                    } else {
                        throw new Error('Subscription failed');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    messageDiv.innerHTML = '<p style="color: #ff4d4d;">Something went wrong. Please try again.</p>';
                } finally {
                    subscribeBtn.textContent = 'Subscribe';
                    subscribeBtn.disabled = false;
                }
            });
        }
    </script>
</body>

</html>